<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo - SaCars</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
    <header class="site-header">
        <div class="contenedor contenido-header">
            <div class="barra">
                <a href="/">
                    <img class="logo" src="/img/logoprincipal.png" alt="Logotipo de SaCars">
                </a>
                <nav class="navegacion">
                    <a href="/">Inicio</a>
                    <a href="/catalogo">Cat√°logo</a>
                    <a href="/mas-sobre-nosotros">M√°s sobre nosotros</a>
                    <a href="/contacto">Contacto</a>

                    <a href="/carrito" class="carrito-icono">
                        <img src="/img/carritocompras.png" alt="Carrito">
                        <span class="contador-carrito" style="display: none;">0</span>
                    </a>
                </nav>

                <div class="nav-auth">
                    <span id="usuario-conectado" style="display:none; color: #333; margin-right: 15px;">
                        üë§ <strong id="nombre-usuario"></strong>
                    </span>
                    <a href="/auth/login" class="btn-login-header">üîê Ingresar</a>
                    <a href="#" id="btn-logout" class="btn-logout-header" style="display:none;">üö™ Salir</a>
                </div>
            </div>
        </div>
    </header>

    <main class="contenedor seccion-catalogo">
        <h2 class="centrar-texto">Cat√°logo de Hot Wheels</h2>

        <!-- Panel de Controles con jQuery -->
        <div class="catalogo-controles">
            <div class="control-grupo">
                <label for="buscar-producto">üîç Buscar:</label>
                <input type="text" id="buscar-producto" placeholder="Busca por nombre...">
            </div>

            <div class="control-grupo">
                <label for="filtro-categoria">üìÅ Categor√≠a:</label>
                <select id="filtro-categoria">
                    <option value="todos">Todas las categor√≠as</option>
                    <option th:each="cat : ${categorias}" th:value="${cat.idCategoria}" th:text="${cat.nombre}"></option>
                </select>
            </div>

            <div class="control-grupo">
                <label for="filtro-precio">üí∞ Filtrar por precio:</label>
                <select id="filtro-precio">
                    <option value="todos">Todos los precios</option>
                    <option value="economico">Econ√≥micos (S/ 15 - S/ 20)</option>
                    <option value="medio">Medianos (S/ 21 - S/ 30)</option>
                    <option value="premium">Premium (S/ 31+)</option>
                </select>
            </div>

            <div class="control-grupo">
                <label for="ordenar-por">üìä Ordenar por:</label>
                <select id="ordenar-por">
                    <option value="default">Por defecto</option>
                    <option value="precio-asc">Precio: Menor a Mayor</option>
                    <option value="precio-desc">Precio: Mayor a Menor</option>
                    <option value="nombre-asc">Nombre: A-Z</option>
                    <option value="nombre-desc">Nombre: Z-A</option>
                </select>
            </div>

            <button id="limpiar-filtros" class="boton-amarillo btn-outline">üîÑ Limpiar Filtros</button>
        </div>

        <div class="resultados-info">
            <p>Mostrando <span id="contador-productos" th:text="${#lists.size(productos)}">0</span> productos</p>
        </div>

        <div class="grid-catalogo" id="catalogo-productos">
            <!-- Productos din√°micos con Thymeleaf -->
            <div th:each="producto : ${productos}" 
                 class="anuncio producto-item" 
                 th:data-nombre="${producto.nombre}" 
                 th:data-precio="${producto.precio}"
                 th:data-categoria="${producto.idCategoria}"
                 th:data-stock="${producto.stock}">
                <img th:src="${producto.imagenUrl != null ? producto.imagenUrl : '/img/default-product.png'}" 
                     th:alt="${producto.nombre}">
                <div class="contenido-anuncio">
                    <h3 th:text="${producto.nombre}">Nombre del producto</h3>
                    <p th:text="${#strings.abbreviate(producto.descripcion, 150)}">Descripci√≥n corta...</p>
                    <p class="precio">S/ <span th:text="${#numbers.formatDecimal(producto.precio, 1, 2)}">0.00</span></p>
                    <span class="badge-stock" th:if="${producto.stock <= 3}" th:text="'‚ö†Ô∏è Solo ' + ${producto.stock} + ' disponibles'"></span>
                    <button class="boton-amarillo btn-ver-producto" 
                            th:data-id="${producto.id}"
                            th:data-imagen="${producto.imagenUrl != null ? producto.imagenUrl : '/img/default-product.png'}"
                            th:data-titulo="${producto.nombre}"
                            th:data-descripcion="${producto.descripcion}"
                            th:data-precio="${#numbers.formatDecimal(producto.precio, 1, 2)}"
                            th:data-stock="${producto.stock}">
                        Ver Producto
                    </button>
                </div>
            </div>
            
            <!-- Mensaje cuando no hay productos -->
            <div th:if="${#lists.isEmpty(productos)}" class="sin-productos centrar-texto">
                <p>No hay productos disponibles en este momento.</p>
            </div>
        </div>

        <div class="paginacion" id="paginacion-controles">
            <button id="btn-anterior" class="boton-paginacion" disabled>‚Üê Anterior</button>
            <span id="info-pagina">P√°gina 1 de 3</span>
            <button id="btn-siguiente" class="boton-paginacion">Siguiente ‚Üí</button>
        </div>

        <div id="sin-resultados" class="sin-resultados" style="display: none;">
            <p> No se encontraron productos con los filtros seleccionados.</p>
            <button id="reset-busqueda" class="boton-amarillo">Limpiar b√∫squeda</button>
        </div>
    </main>

    <footer class="site-footer">
        <div class="contenedor">
            <p class="copyright">Todos los Derechos Reservados SaCars 2025 &copy;</p>
        </div>
    </footer>

    <div id="modal-producto" class="modal">
        <div class="modal-contenido">
            <span class="modal-cerrar">&times;</span>
            <div class="modal-body">
                <div class="modal-imagen">
                    <img id="modal-img" src="" alt="Imagen del Producto">
                </div>
                <div class="modal-texto">
                    <h3 id="modal-titulo"></h3>
                    <p id="modal-descripcion"></p>
                    <p id="modal-precio" class="precio"></p>
                    
                    <!-- Selector de cantidad -->
                    <div class="cantidad-selector" style="margin: 15px 0; display: flex; align-items: center; gap: 10px;">
                        <label for="cantidad-producto" style="font-weight: bold;">Cantidad:</label>
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <button type="button" id="btn-restar" class="btn-cantidad" style="width: 35px; height: 35px; font-size: 18px; cursor: pointer; background: #f0f0f0; border: 1px solid #ccc; border-radius: 5px;">‚àí</button>
                            <input type="number" id="cantidad-producto" value="1" min="1" max="10" 
                                   style="width: 60px; text-align: center; font-size: 16px; padding: 5px; border: 1px solid #ccc; border-radius: 5px;">
                            <button type="button" id="btn-sumar" class="btn-cantidad" style="width: 35px; height: 35px; font-size: 18px; cursor: pointer; background: #f0f0f0; border: 1px solid #ccc; border-radius: 5px;">+</button>
                        </div>
                        <span id="stock-disponible" style="color: #666; font-size: 14px;"></span>
                    </div>
                    
                    <div class="modal-botones">
                        <button class="boton-comprar">Comprar Ahora</button>
                        <button class="boton-agregar">Agregar al Carrito</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-envio" class="modal">
        <div class="modal-contenido modal-envio-contenido">
            <span class="modal-cerrar-envio">&times;</span>
            <div class="modal-envio-body">
                <h3>Selecciona tu zona de env√≠o</h3>
                <p class="modal-envio-descripcion">Elige la zona donde deseas recibir tu pedido. Esta selecci√≥n aplicar√°
                    para toda tu compra.</p>

                <div class="zonas-envio">
                    <div class="zona-item" data-zona="Banda de Shilcayo" data-costo="5">
                        <div class="zona-info">
                            <h4>üìç Banda de Shilcayo</h4>
                            <p class="zona-precio">S/ 5.00</p>
                        </div>
                    </div>

                    <div class="zona-item" data-zona="Tarapoto" data-costo="7">
                        <div class="zona-info">
                            <h4>üìç Tarapoto</h4>
                            <p class="zona-precio">S/ 7.00</p>
                        </div>
                    </div>

                    <div class="zona-item" data-zona="Morales" data-costo="10">
                        <div class="zona-info">
                            <h4>üìç Morales</h4>
                            <p class="zona-precio">S/ 10.00</p>
                        </div>
                    </div>

                    <div class="zona-item zona-otros" data-zona="Otros">
                        <div class="zona-info">
                            <h4>üìç Otros lugares de Per√∫</h4>
                            <p class="zona-descripcion">Coordina el precio de env√≠o directamente por WhatsApp</p>
                        </div>
                        <button class="boton-whatsapp">üí¨ Contactar por WhatsApp</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/modal.js"></script>
    <script src="/js/catalogo-filtros.js"></script>
    <script src="/js/auth-check.js"></script>
</body>

</html>